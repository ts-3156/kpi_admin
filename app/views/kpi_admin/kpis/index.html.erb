<%= render partial: 'selector' %>

<div class="row">
  <div class="col-xs-12">
    <%= image_tag asset_path('kpi_admin/ajax-loader.gif') %>
    <div class="kpis uu"></div>
    <div><%= link_to('PV/UU', one_path, class: 'btn btn-default') %></div>
  </div>

  <div class="col-xs-12">
    <%= image_tag asset_path('kpi_admin/ajax-loader.gif') %>
    <div class="kpis search_num"></div>
    <div><%= link_to('Search num', two_path, class: 'btn btn-default') %></div>
  </div>

  <div class="col-xs-12">
    <%= image_tag asset_path('kpi_admin/ajax-loader.gif') %>
    <div class="kpis new_user"></div>
    <div><%= link_to('New user', one_path, class: 'btn btn-default') %></div>
  </div>

  <div class="col-xs-12">
    <%= image_tag asset_path('kpi_admin/ajax-loader.gif') %>
    <div class="kpis sign_in"></div>
    <div><%= link_to('Sign in', one_path, class: 'btn btn-default') %></div>
  </div>

  <div class="col-xs-12">
    <div><%= link_to('RR', rr_path, class: 'btn btn-default') %></div>
    <div><%= link_to('Table', table_path, class: 'btn btn-default') %></div>
  </div>
</div>


<script>
  function reload() {
    $('.kpis').empty();

    var url = "<%= one_path %>";
    fetch(url, 'uu')
        .then(function(){return fetch(url, 'search_num', true)})
        .then(function(){return fetch(url, 'new_user')})
        .then(function(){return fetch(url, 'sign_in')});
  }

  $('input[name=time_zone]:radio').on('change', reload);
  $('input[name=frequency]:radio').on('change', reload);
  $('input[name=duration]:radio').on('change', reload);
  $('input[name=user_id]:radio').on('change', reload);
  $('input[name=ego_surfing]:radio').on('change', reload);
  $('input[name=_action]:radio').on('change', reload);
  $('input[name=device_type]:radio').on('change', reload);
  $('input[name=channel]:radio').on('change', reload);

  $(function () {
    reload();
  });
</script>
